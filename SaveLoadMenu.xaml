<Window x:Class="VisualNovel.SaveLoadMenu"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Save/Load Game" Height="600" Width="700"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="NoResize"
        WindowStartupLocation="CenterScreen"
        ShowInTaskbar="False">
    <Window.Resources>
        <!-- Dialogues Latin Font Family (will be set programmatically) -->
        <FontFamily x:Key="MinecraftFont">Arial</FontFamily>
        
        <!-- ScrollBar Line Button Style (for up/down arrows) - Must be defined before GameScrollBarStyle -->
        <Style x:Key="ScrollBarLineButtonStyle" TargetType="RepeatButton">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Focusable" Value="False"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RepeatButton">
                        <Border Background="{TemplateBinding Background}" 
                               BorderThickness="{TemplateBinding BorderThickness}"
                               Width="14"
                               Height="14">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"
                                            Content="{TemplateBinding Content}">
                                <ContentPresenter.Resources>
                                    <Style TargetType="Path">
                                        <Setter Property="Fill" Value="#60FFFFFF"/>
                                        <Setter Property="Stretch" Value="Uniform"/>
                                    </Style>
                                </ContentPresenter.Resources>
                            </ContentPresenter>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#20FFFFFF"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#40FFFFFF"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Custom ScrollBar Thumb Style -->
        <Style x:Key="GameScrollBarThumbStyle" TargetType="Thumb">
            <Setter Property="Background" Value="#40FFFFFF"/>
            <Setter Property="BorderBrush" Value="#60FFFFFF"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Thumb">
                        <Border Background="{TemplateBinding Background}" 
                               BorderBrush="{TemplateBinding BorderBrush}"
                               BorderThickness="{TemplateBinding BorderThickness}"
                               CornerRadius="2">
                            <Border.Effect>
                                <DropShadowEffect Color="#FF8B7355" BlurRadius="2" ShadowDepth="1" Opacity="0.3"/>
                            </Border.Effect>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#60FFFFFF"/>
                    <Setter Property="BorderBrush" Value="#FFFFD700"/>
                    <Setter Property="BorderThickness" Value="2"/>
                </Trigger>
                <Trigger Property="IsDragging" Value="True">
                    <Setter Property="Background" Value="#80FFFFFF"/>
                    <Setter Property="BorderBrush" Value="#FFFFD700"/>
                    <Setter Property="BorderThickness" Value="2"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Custom ScrollBar Style -->
        <Style x:Key="GameScrollBarStyle" TargetType="ScrollBar">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Width" Value="14"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollBar">
                        <Grid x:Name="GridRoot">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="0*" MaxHeight="0"/>
                                <RowDefinition Height="0.00001*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="1" 
                                   Background="Transparent"
                                   BorderBrush="#20FFFFFF"
                                   BorderThickness="0,0,1,0"
                                   Margin="0,2,0,2"/>
                            <Track x:Name="PART_Track" 
                                  Grid.Row="1" 
                                  IsDirectionReversed="True"
                                  Focusable="False">
                                <Track.DecreaseRepeatButton>
                                    <RepeatButton Style="{StaticResource ScrollBarLineButtonStyle}" 
                                                 Command="ScrollBar.LineUpCommand" 
                                                 Content="M 0 4 L 4 4 L 2 0 Z"/>
                                </Track.DecreaseRepeatButton>
                                <Track.IncreaseRepeatButton>
                                    <RepeatButton Style="{StaticResource ScrollBarLineButtonStyle}" 
                                                 Command="ScrollBar.LineDownCommand" 
                                                 Content="M 0 0 L 4 0 L 2 4 Z"/>
                                </Track.IncreaseRepeatButton>
                                <Track.Thumb>
                                    <Thumb Style="{StaticResource GameScrollBarThumbStyle}"/>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ScrollViewer Style -->
        <Style x:Key="GameScrollViewerStyle" TargetType="ScrollViewer">
            <Setter Property="Padding" Value="15,10"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollViewer">
                        <Border Background="Transparent"
                               BorderBrush="#40FFFFFF"
                               BorderThickness="1"
                               CornerRadius="2">
                            <Grid x:Name="Grid" Background="{TemplateBinding Background}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <ScrollContentPresenter x:Name="PART_ScrollContentPresenter" 
                                                      CanContentScroll="{TemplateBinding CanContentScroll}" 
                                                      CanHorizontallyScroll="False" 
                                                      CanVerticallyScroll="False" 
                                                      ContentTemplate="{TemplateBinding ContentTemplate}" 
                                                      Content="{TemplateBinding Content}" 
                                                      Grid.Column="0" 
                                                      Margin="{TemplateBinding Padding}"/>
                                <ScrollBar x:Name="PART_VerticalScrollBar" 
                                         AutomationProperties.AutomationId="VerticalScrollBar" 
                                         Cursor="Arrow" 
                                         Grid.Column="1" 
                                         Maximum="{TemplateBinding ScrollableHeight}" 
                                         Minimum="0" 
                                         Orientation="Vertical" 
                                         ViewportSize="{TemplateBinding ViewportHeight}" 
                                         Value="{Binding VerticalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}, UpdateSourceTrigger=PropertyChanged}" 
                                         Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"
                                         Style="{StaticResource GameScrollBarStyle}"
                                         Margin="5,0,0,0"/>
                                <ScrollBar x:Name="PART_HorizontalScrollBar" 
                                         AutomationProperties.AutomationId="HorizontalScrollBar" 
                                         Cursor="Arrow" 
                                         Grid.Column="0" 
                                         Grid.Row="1" 
                                         Maximum="{TemplateBinding ScrollableWidth}" 
                                         Minimum="0" 
                                         Orientation="Horizontal" 
                                         ViewportSize="{TemplateBinding ViewportWidth}" 
                                         Value="{Binding HorizontalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}, UpdateSourceTrigger=PropertyChanged}" 
                                         Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"
                                         Style="{StaticResource GameScrollBarStyle}"/>
                            </Grid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Save Slot Button Style -->
        <Style x:Key="SaveSlotButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="BorderBrush" Value="#40FFFFFF"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                               BorderBrush="{TemplateBinding BorderBrush}" 
                               BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Left" 
                                             VerticalAlignment="Center"
                                             Margin="15,10"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#20FFFFFF"/>
                    <Setter Property="BorderBrush" Value="#FFFFD700"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Dialog Button Style -->
        <Style x:Key="DialogButtonStyle" TargetType="Button">
            <Setter Property="Width" Value="120"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="FontFamily" Value="{StaticResource MinecraftFont}"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#CCFFFFFF"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="BorderBrush" Value="#40FFFFFF"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                               BorderBrush="{TemplateBinding BorderBrush}" 
                               BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center" 
                                             VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#20FFFFFF"/>
                    <Setter Property="BorderBrush" Value="#FFFFD700"/>
                    <Setter Property="Foreground" Value="#FFFFD700"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>
    
    <Border Background="#E0000000" 
           BorderBrush="#60FFFFFF" 
           BorderThickness="3">
        <Border.Effect>
            <DropShadowEffect BlurRadius="0" 
                             ShadowDepth="3" 
                             Color="Black" 
                             Opacity="0.9"/>
        </Border.Effect>
        <Grid Margin="30">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Title -->
            <TextBlock x:Name="TitleText" 
                      Grid.Row="0"
                      Text="Save Game" 
                      FontFamily="{StaticResource MinecraftFont}"
                      FontSize="28" 
                      FontWeight="Bold" 
                      Foreground="#FFFFD700"
                      Margin="0,0,0,20">
                <TextBlock.Effect>
                    <DropShadowEffect BlurRadius="0" 
                                     ShadowDepth="2" 
                                     Color="#FFFFD700" 
                                     Opacity="0.8"/>
                </TextBlock.Effect>
            </TextBlock>

            <!-- Save Slots -->
            <ScrollViewer Grid.Row="1" 
                         VerticalScrollBarVisibility="Auto"
                         Margin="0,0,0,20"
                         Style="{StaticResource GameScrollViewerStyle}">
                <ItemsControl x:Name="SaveSlotsContainer" Margin="0,0,10,0">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </ScrollViewer>

            <!-- Buttons -->
            <StackPanel Grid.Row="2" 
                       Orientation="Horizontal" 
                       HorizontalAlignment="Right">
                <Button x:Name="CancelButton" 
                       Content="Cancel" 
                       Style="{StaticResource DialogButtonStyle}"
                       Click="CancelButton_Click"/>
            </StackPanel>
        </Grid>
    </Border>
</Window>

